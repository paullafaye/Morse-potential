from __future__ import division
import numpy as np
from scipy.integrate import quad

Na = 6.022140857*10**23
kB = 1.380649*10**(-23)

def f_vib(tD, Tm):
    result = []
    temperature = [0]
    debye = lambda x:(x**3)/((np.exp(x)-1))
    
    for t in np.arange(1, Tm, 10):
        temperature.append(t)
        integral_x = quad(debye, 0, tD/t)[0]
        result.append(Na*kB*t*((9*tD/(8*t))+3*np.log(1-np.exp(-tD/t))-3*((t/tD)**3)*integral_x))
        
    return temperature, result


if __name__ == "__main__": 
     restst = [3521.20461567038, 3521.16016409871, 3520.61411157796, 3518.40169944724, 3512.66736131811, 3501.08432530392, 3481.29159030013, 3451.28314606393, 3409.57641249803, 3355.20310832362, 3287.61979274920, 3206.60265625111, 3112.15477499147, 3004.43348738511, 2883.69684412498, 2750.26548435600, 2604.49603435460, 2446.76288390075, 2277.44586596228, 2096.92205753235, 1905.56047321895, 1703.71872652158, 1491.74106091930, 1269.95732047359, 1038.68253912174, 798.216966557068, 548.846360677233, 290.842464496772, 24.4635860411441, -250.044763057127, -532.449204143624, -822.527824652014, -1120.06952139613, -1424.87337073620, -1736.74801958545, -2055.51111248012, -2380.98874756665, -2713.01496729521, -3051.43127940085, -3396.08621017962, -3746.83488617627, -4103.53864617129, -4466.06467852719, -4834.28567775461, -5208.07953664511, -5587.32904867867, -5971.92163646255, -6361.74909018235, -6756.70733941391, -7156.69622182653, -7561.61928257373, -7971.38357797801, -8385.89949406485, -8805.08057389169, -9228.84336862199, -9657.10727731228, -10089.7944115558, -10526.8294732141, -10968.1396149107, -11413.6543427030, -11863.3053921250, -12317.0266321607, -12774.7539778045, -13236.4252807608, -13701.9802633308, -14171.3604230241, -14644.5089608429, -15121.3707189379, -15601.8920963847, -16086.0209912825, -16573.7067510595, -17064.9000906749, -17559.5530647742, -18057.6189930868, -18559.0524206619, -19063.8091019974, -19571.8458519144, -20083.1206485567, -20597.5924869115, -21115.2213873983, -21635.9683612456, -22159.7952973370, -22686.6650617879, -23216.5413645460, -23749.3887745322, -24285.1726835841, -24823.8592246710, -25365.4153520902, -25909.8087288548, -26457.0077478604, -27006.9814915092, -27559.6996633171, -28115.1326814716, -28673.2515470366]
     restst = [np.round(r,0) for r in restst] ## compare just up to the third decimal
     result = f_vib(376.447744459516, 933)[1]
     result = [np.round(r,0) for r in result]
     assert result == restst
     print('passed')

