from __future__ import division
import numpy as np
from scipy.integrate import quad

Na = 6.022140857*10**23
kB = 1.380649*10**(-23)

def cv_vib(tD, Tm):
    result = [0]
    temperature = [0]
    debye = lambda x:(x**4)*np.exp(x)/(((np.exp(x)-1)**2))
    
    for t in np.arange(1, Tm, 10):
        temperature.append(t)
        integral_x = quad(debye, 0, tD/t)[0]
        result.append(9*Na*kB*((t/tD)**3)*integral_x)
        
    return temperature, result


if __name__ == "__main__": 
     restst = [0, 0.364359984968969e-4, 0.484963140016236e-1, .337405958450450, 1.07857075205653, 2.39719139872675, 4.20351933063844, 6.25942106064226, 8.33678804892598, 10.2886864908162, 12.0451915312032, 13.5870159896278, 14.9221559801707, 16.0707723622737, 17.0567773071002, 17.9036545607454, 18.6326534503036, 19.2622123172658, 19.8079708158110, 20.2830327658733, 20.6983101607201, 21.0628684313054, 21.3842392948064, 21.6686901109080, 21.9214495717615, 22.1468938124884, 22.3486986396263, 22.5299633185924, 22.6933113293205, 22.8409721390234, 22.9748478513774, 23.0965675793288, 23.2075319185263, 23.3089493710687, 23.4018665333635, 23.4871928479140, 23.5657212633815, 23.6381453524872, 23.7050737192818, 23.7670419141068, 23.8245226418946, 23.8779342678278, 23.9276480370147, 23.9739942485682, 24.0172675171623, 24.0577311992873, 24.0956213090903, 24.1311497800394, 24.1645073768696, 24.1958660998918, 24.2253813935448, 24.2531940003997, 24.2794315302744, 24.3042099843562, 24.3276348955261, 24.3498025461724, 24.3708008166103, 24.3907100823619, 24.4096039706968, 24.4275500417807, 24.4446103169188, 24.4608418743171, 24.4762973275475, 24.4910251249322, 24.5050700496294, 24.5184735217653, 24.5312738451482, 24.5435065178713, 24.5552045274057, 24.5663984373511, 24.5771167213341, 24.5873858501983, 24.5972304733214, 24.6066736209672, 24.6157367486125, 24.6244399139277, 24.6328018770024, 24.6408401806686, 24.6485712850937, 24.6560105887349, 24.6631725709007, 24.6700707870979, 24.6767180239106, 24.6831262535085, 24.6893067987219, 24.6952702743419, 24.7010267189861, 24.7065855757575, 24.7119557582955, 24.7171456919255, 24.7221633564841, 24.7270162539343, 24.7317115283422, 24.7362559013023, 24.7406557558685]
     restst = [np.round(r,3) for r in restst] ## compare just up to the third decimal
     result = cv_vib(376.447744459516, 933)[1]
     result = [np.round(r,3) for r in result]
     assert result == restst
     print('passed')

