from __future__ import division
import numpy as np
from scipy.integrate import quad

Na = 6.022140857*10**23
kB = 1.380649*10**(-23)
e = 1.602176620898*10**(-19)

def alpha_vib(a, r0, d, tD, tM):
    temperature = [0]
    result = [0]
    debye = lambda x: (x**4*np.exp(x))/((np.exp(x)-1)**2)
    
    for t in np.arange(1, tM, 10):
        temperature.append(t)
        integrale_x = quad(debye, 0, tD/t)[0]
        result.append(100000*((9*kB)/(2*e*a*r0*d))*(t/tD)**3*integrale_x)
                      
    return temperature, result


if __name__ == "__main__": 
     restst = [0, 0.102504535370188*10**(-4), 0.136433536577720*10**(-1), 0.949216226563294*10**(-1), .303431766343533, .674396203327456, 1.18256618088487, 1.76094816638397, 2.34536892312258, 2.89449190875696, 3.38864532927563, 3.82240316871912, 4.19801495359317, 4.52115249184013, 4.79854293898706, 5.03679291978173, 5.24188045663595, 5.41899276951383, 5.57252972125682, 5.70617777832302, 5.82300678920520, 5.92556710765401, 6.01597761494814, 6.09600149212026, 6.16710971452455, 6.23053341150807, 6.28730668768482, 6.33830145260877, 6.38425576217557, 6.42579682898742, 6.46345976909289, 6.49770289484549, 6.52892022687530, 6.55745176181883, 6.58359192653239, 6.60759657853023, 6.62968879163838, 6.65006369201033, 6.66889249023036, 6.68632585605328, 6.70249677349255, 6.71752294154265, 6.73150879891788, 6.74454726930639, 6.75672123539944, 6.76810478776216, 6.77876432310625, 6.78875946372061, 6.79814387790872, 6.80696595363269, 6.81526942133621, 6.82309387655302, 6.83047521905742, 6.83744608287805, 6.84403615796877, 6.85027253089770, 6.85617992456354, 6.86178095136273, 6.86709632440414, 6.87214504730458, 6.87694457436835, 6.88151096508087, 6.88585900798673, 6.89000234442481, 6.89395357199382, 6.89772433731261, 6.90132542099549, 6.90476681353209, 6.90805778520113, 6.91120694293198, 6.91422229216289, 6.91711127957308, 6.91988084689469, 6.92253746496796, 6.92508717313512, 6.92753561370902, 6.92988806402836, 6.93214946207687, 6.93432443501584, 6.93641731745062, 6.93843217962423, 6.94037284015754, 6.94224289059409, 6.94404570383045, 6.94578446242303, 6.94746215237919, 6.94908159982042, 6.95064545887007, 6.95215623908486, 6.95361631239707, 6.95502791950552, 6.95639317454806, 6.95771408342203, 6.95899254225147, 6.96023034296547]
     restst = [np.round(r,3) for r in restst] ## compare just up to the third decimal
     #print("flag1", restst)
     result = alpha_vib(1.14252739207463, 2.86106791103832, 0.563509849393325, 376.447744459516, 933)[1]
     result = [np.round(r,3) for r in result]
     #print("flag2", result)
     assert result == restst
     print('passed')