from __future__ import division
import numpy as np
from scipy.integrate import quad

Na = 6.022140857*10**23
kB = 1.380649*10**(-23)
    
def u_vib(tD, tM):
    result = [0]
    temperature = [0]
    debye = lambda x: x**3/(np.exp(x)-1)
    
    for t in np.arange(1, tM, 10):
        temperature.append(t)
        integrale_x = quad(debye, 0, tD/t)[0]
        result.append(9*Na*kB*t*(t/tD)**3*integrale_x)
        
    return temperature, result
    
    
if __name__ == "__main__": 
     restst = [0, 0.910899962254736e-5, .133364863483329, 1.77149676648445, 8.39641019727545, 25.2960232532891, 57.9834274896801, 110.195537091407, 183.233375876726, 276.504296594088, 388.350246363297, 516.689613232539, 659.400355621675, 814.510624974008, 980.273842100950, 1155.18267566353, 1337.95432518355, 1527.50459249804, 1722.91951905277, 1923.42859691600, 2128.38109690009, 2337.22590692038, 2549.49464843791, 2764.78774032411, 2982.76290859956, 3203.12575882749, 3425.62204836574, 3650.03131820496, 3876.16163752328, 4103.84529097156, 4332.93515971712, 4563.30174819332, 4794.83068236461, 5027.42058340202, 5260.98134680185, 5495.43262572763, 5730.70255761807, 5966.72671303785, 6203.44715264676, 6440.81165835913, 6678.77303958546, 6917.28855660199, 7156.31940698928, 7395.83029315945, 7635.78904994901, 7876.16628122164, 8116.93509257594, 8358.07083606639, 8599.55085492422, 8841.35432738676, 9083.46204145113, 9325.85627774624, 9568.52066837843, 9811.44004676736, 10054.6003575475, 10297.9885514531, 10541.5925102364, 10785.4009415523, 11029.4033309063, 11273.5898605655, 11517.9513765225, 11762.4793074070, 12007.1656254429, 12252.0028224221, 12496.9838556454, 12742.1020878568, 12987.3513142733, 13232.7256754891, 13478.2196604795, 13723.8280825745, 13969.5460524288, 14215.3689299699, 14461.2923514273, 14707.3121872864, 14953.4245543021, 15199.6257284031, 15445.9122107645, 15692.2806917681, 15938.7279909370, 16185.2511380241, 16431.8472889201, 16678.5137166439, 16925.2478593949, 17172.0472785070, 17418.9096284161, 17665.8326926991, 17912.8143450316, 18159.8525672071, 18406.9454251112, 18654.0910717248, 18901.2877711502, 19148.5337964995, 19395.8275680457, 19643.1675300881, 19890.5521960015]
     restst = [np.round(r,0) for r in restst] ## compare just up to the third decimal
     result = u_vib(376.447744459516, 933)[1]
     result = [np.round(r,0) for r in result]
     assert result == restst
     print('passed')